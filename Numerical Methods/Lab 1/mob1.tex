\documentclass[a4paper,14pt]{extarticle} %the default article class is limited to 12pt, but you can go up to 14, 17 or 20 points if you use the extarticle class:
\usepackage{cmap} %make LaTeX PDF output copy-and-pasteable
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc} %coding
\usepackage[english,ukrainian]{babel}
\usepackage{amssymb,amsfonts,amsmath,cite,enumerate,float}
\usepackage{indentfirst} %set an additional space before a paragraph at the begining of new section
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{varwidth}
\usepackage{setspace}

\graphicspath{{images/}} %path to images

\usepackage[table,xcdraw]{xcolor}

\parskip=1mm %space between paragraphs

\usepackage{geometry} 
\geometry{left=1.25cm}
\geometry{right=1.25cm}
\geometry{top=1cm}
\geometry{bottom=2cm}

\usepackage{listings} %for code

\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{
    frame=tb,
    language=Python,
    aboveskip=3mm,
    belowskip=3mm,
    showstringspaces=false,
    columns=flexible,
    basicstyle={\small\ttfamily},
    numbers=none,
    numberstyle=\tiny\color{gray},
    keywordstyle=\color{blue},
    commentstyle=\color{dkgreen},
    stringstyle=\color{mauve},
    breaklines=true,
    breakatwhitespace=true,
    tabsize=3
}

\begin{document}

\input{title}

\newpage
\tableofcontents

\newpage

\section*{Завдання}
\begin{enumerate} 

    \item Здійснити в якості допрограмового етапу аналіз 
    та відокремлення коренів за допомогою теорем. Зокрема, 
    визначити кількість дійсних коренів рівняння (теорема 
    Гюа, теорема Штурма),відокремити дійсні корені рівняння 
    (теорема про верхню межу). До аналізу комплексних коренів
    застосувати теорему про кільце. Результатом цього етапу 
    повинна бути послідовність проміжків,кожен із яких 
    містить лише один дійсний корінь рівняння.

    \item Програмний етап полягає в тому, щоб уточнити корені 
    рівняння методом бісекції, методом хорд, методом дотичних.

    \item Порівняти отримані результати, зробити висновки, 
    який метод приводить до меншої кількості ітерацій і чим це зумовлено.

\end{enumerate}

\section{Відокремлення коренів}

Розглядається рівняння $f(x)=0$, де 
$f(x)=P_5(x)=6x^5-3x^4+x^3+2x^2-4x+2.$
\subsection{Теорема про границі усіх коренів рівняння}

\textbf{Теорема:} \textit{Нехай $A=\max{a_i}, i=\overline{0,n-1}, 
B=\max{a_i}, i=\overline{1,n}$, тоді всі (і комплексні теж) корені $x^{*}$
рівняння $P_n(x)=0$ лежать у такому кільці: 
\[ \dfrac{|a_0|}{B+|a_0|} \leqslant |x^{*}| \leqslant \dfrac{|a_n|+A}{|a_n|}. \]}

\textbf{Отже}, для заданого рівняння $P_5(x)=6x^5-3x^4+x^3+2x^2-4x+2=0$ матимемо: 
\[ \dfrac{2}{2+6} \leqslant |x^{*}| \leqslant \dfrac{6+4}{6} 
\Rightarrow 0.25 \leqslant |x^{*}| \leqslant 1.66. \]

\subsection{Теорема про верхню межу додатніх коренів}

\textbf{Теорема:} \textit{нехай $B=\max{|a_i|}$ для $a_i<0$, а також 
$m=\max{i}$ для $a_i<0$. Тоді значення $R=1+\sqrt[n-m]{\frac{B}{a_n}}$ 
є верхнею межею всіх додатніх коренів: $\forall{x^{+}}\leqslant R: P_n(x^{+})=0.$
Для визначення нижньої межі додатніх коренів стосовно вихідного поліному 
робимо заміну $x=\frac{1}{y}$, а для верхньої та нижньої межі від'ємних
коренів робимо відповідні заміни $x=-\frac{1}{y}$ та $x=-y$.}

\begin{enumerate}

    \item Для $P(x)=6x^5-3x^4+x^3+2x^2-4x+2=0: n=5,m=4,B=4 \Rightarrow$ \\
    отримуємо значення $R=1+\frac{4}{6}=\frac{5}{3};$
    \item Для $P_1=y^nP(\frac{1}{y})=2y^5-4y^4+2y^3+y^2-3y+6=0: n=5,m=4,B=4 \Rightarrow$ 
    отримуємо значення $R_1=1+\frac{4}{2}=3;$
    \item Для $P_2=P(-y)=-6x^5-3x^4-x^3+2x^2+4x+2=0.$ Домноживши поліном на -1 матимемо
    $P_2=6x^5+3x^4+x^3-2x^2-4x-2=0: n=5,m=2,B=4 \Rightarrow$ 
    отримуємо значення $R_2=1+\sqrt[3]{2/3};$
    \item Для $P_3=y^nP(-\frac{1}{y})=2y^5+4y^4+2y^3-y^2-3y-6=0: n=5,m=2,B=6 \Rightarrow$ 
    отримуємо значення $R_3=1+\sqrt[3]{3};$

\end{enumerate}

\textbf{Отже}, матимемо систему нерівностей $\dfrac{1}{R_1} \leqslant x^{+} \leqslant R$,
 $-R_2 \leqslant x^{-} \leqslant -\dfrac{1}{R_3}$. Таким чином 
$x^{+} \in [0.33,1.66]$ й $x^{-} \in [$-1.87,-0.41].

\subsection{Теорема про верхню межу (спосіб Лагранжа)}

\textbf{Теорема:} \textit{Представимо поліном $P(x)$ у вигляді
$P(x)=F(x)+\Phi (x)$, де $F(x)$ містить всі поспіль старші
члени рівняння з додатніми коефіцієнтами, а також всі члени з від'ємними
коефіцієнтами. $\Phi (x)$ містить решту членів з додатніми коефіцієнтами.
Нехай $\exists \alpha>0: F(\alpha)>0$, тоді $\forall{x^{+}}\leqslant \alpha: P_n(x^{+})=0.$}

Складемо поліноми $F(x)$ та $\Phi (x)$: 
\[ F(x)= 6x^5-3x^4-4x, \ \Phi (x)= x^3+2x^2+2 \]

Уточнимо верхню межу додатніх коренів: \[ F(1.07)>0 \Rightarrow x^{+} \leqslant 1.07. \]

\textbf{Отже}, після уточнення способом Лагранжа матимемо такі проміжки коренів: 
$x^{+} \in [0.33,1.07]$ й $x^{-} \in [$-1.87,-0.41].

\subsection{Теорема Гюа про наявність комплексних коренів}

\textbf{Теорема:} \textit{якщо $\exists{k}: 0< k < n: 
a_k^2<a_{k-1} \cdot a_{k+1}$, то рівняння має хоча б одну пару 
комплексно спряжених коренів.}

Перевіримо систему нерівностей для відповідних значень 
$a_5=6, a_4=-3$, \\$a_3=1, a_2=2, a_1=-4 \text{ та } a_0=2.$

\[ \text{При значенні } k=4 \text{ отримуємо хибну нерівність: } 9<6 \]
\[ \text{При значенні } k=3 \text{ отримуємо хибну нерівність: } 1<-6 \]
\[ \text{При значенні } k=2 \text{ отримуємо хибну нерівність: } 4<-4 \]
\[ \text{При значенні } k=1 \text{ отримуємо хибну нерівність: } 16<4 \]

\textbf{Отже}, теорема не дає змоги зробити висновки про наявність 
комплексно спряжених коренів.

\subsection{Теорема Штурма про чередування коренів}

\textbf{Теорема:} \textit{нехай $f(x)=P_n(x)$ -- поліном без 
кратних коренів. Утворимо таку послідовність многочленів: 
$P_0(x)=P_n(x),P_1(x)=P_n^{'}(x),$, а для усіх наступних 
$P_{i+1}(x)=-[P_{i-1}(x) \bmod P_{i}(x)],$ де $i=\overline{1,n-1},$
тобто кожний наступний многочлен є залишком від ділення двох попередніх 
многочленів, взятим з протилежним знаком. Тоді кількість дійсних
коренів полінома $P_0(x)$ на довільному відрізку $[a, b]$ 
дорівнює різниці між кількістю змін знаку (КЗЗ) у
цій послідовності при $x=a$ та $x=b$.}

Створимо поліноми: 
\[ P_0(x)=6x^5-3x^4+x^3+2x^2-4x+2 \]
\[ P_1(x)=30x^4-12x^3+3x^2+4x-4 \]
\[ P_2(x)=-[P_0(x) \bmod P_1(x)]=-\frac{1}{50}(8x^3+63x^2-156x+96) \]
\[ P_3(x)=-[P_1(x) \bmod P_2(x)]=-\frac{81374}{32}x^2+\frac{41575}{8}x-2975 \]
\[ P_4(x)=-[P_2(x) \bmod P_3(x)]=-\frac{16949504}{264875625}x+\frac{2399168}{37839375}\]
\[ P_5(x)=-[P_3(x) \bmod P_4(x)]= 322,32\]

\begin{center}
    \begin{table}[h!]
        \centering
        \resizebox{0.5\linewidth}{!}{
        {\setlength{\arrayrulewidth}{0.6pt}
            \begin{tabular}{|c|c|c|c|c|}
                \hline
                 & \textbf{\small{0,33}} & \textbf{\small{1,07}} & \textbf{\small{-1,87}} & \textbf{\small{-0,41}} \\ \hline
                \small{$P_0(x)$} & + & + & -- & + \\ \hline
                \small{$P_1(x)$} & -- & + & + & -- \\ \hline
                \small{$P_2(x)$} & -- & -- & -- & -- \\ \hline
                \small{$P_3(x)$} & -- & -- & -- & -- \\ \hline
                \small{$P_4(x)$} & + & -- & + & + \\ \hline
                \small{$P_5(x)$} & + & + & + & + \\ \hline
                \rowcolor[HTML]{ADD8E6}
                \small{КЗЗ} & \small{2} & \small{2} & \small{3} & \small{2} \\
                \hline
            \end{tabular}}}
        \caption{Знаки поліномів Штурма}
    \end{table}
\end{center}

\textbf{Отже}, на проміжку додатніх значень [0.33,1.07] немає дійсних коренів, 
а на проміжку від'ємних значень [-1.87,-0.41] є один дійсний корінь.

\newpage

\section{Уточнення коренів}

\subsection{Метод бiсекцiї}

\lstinputlisting[language=Python]{bisection.py}

\subsubsection*{Результати й проміжні кроки}

Ітерація 0: \parbox[t]{12cm}{ відрізок [-1.14,-0.41], \\
            значення критерія |a-b| = 0.73, \\ 
            наближене значення кореня = -1.14 \\ } \par
Ітерація 1: \parbox[t]{12cm}{ відрізок [-1.14,-0.775], \\
            значення критерія |a-b| = 0.365, \\ 
            наближене значення кореня = -0.775 \\ } \par
Ітерація 2: \parbox[t]{12cm}{ відрізок [-0.9575,-0.775], \\
            значення критерія |a-b| = 0.1825, \\ 
            наближене значення кореня = -0.9575 \\ } \par
Ітерація 3: \parbox[t]{12cm}{ відрізок [-0.9575,-0.86625], \\
            значення критерія |a-b| = 0.09125, \\ 
            наближене значення кореня = -0.86625 \\ } \par
Ітерація 4: \parbox[t]{12cm}{ відрізок [-0.9575,-0.911875], \\
            значення критерія |a-b| = 0.045625, \\ 
            наближене значення кореня = -0.911875 \\ } \par
Ітерація 5: \parbox[t]{12cm}{ відрізок [-0.9575,-0.9346875], \\
            значення критерія |a-b| = 0.0228125, \\ 
            наближене значення кореня = -0.9346875 \\ } \par
Ітерація 6: \parbox[t]{12cm}{ відрізок [-0.94609375,-0.9346875], \\
            значення критерія |a-b| = 0.01140625, \\ 
            наближене значення кореня = -0.94609375 \\ } \par
Ітерація 7: \parbox[t]{12cm}{ відрізок [-0.94039063,-0.9346875], \\
            значення критерія |a-b| = 0.00570313, \\ 
            наближене значення кореня = -0.94039063 \\ } \par
Ітерація 8: \parbox[t]{12cm}{ відрізок [-0.94039063,-0.93753906], \\
            значення критерія |a-b| = 0.00285156, \\ 
            наближене значення кореня = -0.93753906 \\ } \par
Ітерація 9: \parbox[t]{12cm}{ відрізок [-0.93896484,-0.93753906], \\
            значення критерія |a-b| = 0.00142578, \\ 
            наближене значення кореня = -0.93896484 \\ } \par
Ітерація 10: \parbox[t]{12cm}{ відрізок [-0.93896484,-0.93825195], \\
             значення критерія |a-b| = 0.00071289, \\ 
             наближене значення кореня = -0.93825195 \\ } \par

Кількість ітерацій = 11, епсилон = 0.001, корінь = -0.93825195

\newpage
\subsection{Метод хорд}

\lstinputlisting[language=Python]{chord.py}

\subsubsection*{Результати й проміжні кроки}

Ітерація 0: \parbox[t]{12cm}{ відрізок [-1.87,-0.44267267], \\
            значення критерія f(c) = 3.85867154, \\
            наближене значення кореня = -0.44267267 \\ } \par
Ітерація 1: \parbox[t]{12cm}{ відрізок [-1.87,-0.47549292], \\
            значення критерія f(c) = 3.94745974, \\
            наближене значення кореня = -0.47549292 \\ } \par
Ітерація 2: \parbox[t]{12cm}{ відрізок [-1.87,-0.50827898], \\
            значення критерія f(c) = 4.0147223, \\
            наближене значення кореня = -0.50827898 \\ } \par
Ітерація 12: \parbox[t]{12cm}{ відрізок [-1.87,-0.78685289], \\
            значення критерія f(c) = 2.93877116, \\
            наближене значення кореня = -0.78685289 \\ } \par
Ітерація 22: \parbox[t]{12cm}{ відрізок [-1.87,-0.90477167], \\
            значення критерія f(c) = 0.86741587, \\
            наближене значення кореня = -0.90477167 \\ } \par
Ітерація 32: \parbox[t]{12cm}{ відрізок [-1.87,-0.93206699], \\
            значення критерія f(c) = 0.17113642, \\
            наближене значення кореня = -0.93206699 \\ } \par
Ітерація 42: \parbox[t]{12cm}{ відрізок [-1.87,-0.93715797], \\
            значення критерія f(c) = 0.03078225, \\
            наближене значення кореня = -0.93715797 \\ } \par
Ітерація 52: \parbox[t]{12cm}{ відрізок [-1.87,-0.93806415], \\
            значення критерія f(c) = 0.00544241, \\
            наближене значення кореня = -0.93806415 \\ } \par
Ітерація 62: \parbox[t]{12cm}{ відрізок [-1.87,-0.93822407], \\
            значення критерія f(c) = 0.0009593, \\
            наближене значення кореня = -0.93822407 \\ } \par

Кількість ітерацій = 63, епсилон = 0.001, корінь = -0.93822407

\newpage
\subsection{Метод Ньютона}

\lstinputlisting[language=Python]{newton.py}

\subsubsection*{Результати й проміжні кроки}

Ітерація 0: \parbox[t]{12cm}{ відрізок [-1.22775069,-0.41], \\
            значення критерія |f(x)| = 15.47938621, а значення |x[i+1]-x[i]| = 0.27326272467081925, \\
            наближене значення кореня = -1.22775069 \\ } \par
Ітерація 1: \parbox[t]{12cm}{ відрізок [-1.04772501,-0.41], \\
            значення критерія |f(x)| = 3.95386968, а значення |x[i+1]-x[i]| = 0.18002568265600272, \\
            наближене значення кореня = -1.04772501 \\ } \par
Ітерація 2: \parbox[t]{12cm}{ відрізок [-0.95996629,-0.41], \\
            значення критерія |f(x)| = 0.64076614, а значення |x[i+1]-x[i]| = 0.08775872001303997, \\
            наближене значення кореня = -0.95996629 \\ } \par
Ітерація 3: \parbox[t]{12cm}{ відрізок [-0.93930792,-0.41], \\
            значення критерія |f(x)| = 0.02951474, а значення |x[i+1]-x[i]| = 0.020658365251669863, \\
            наближене значення кореня = -0.93930792 \\ } \par
Ітерація 4: \parbox[t]{12cm}{ відрізок [-0.93826086,-0.41], \\
            значення критерія |f(x)| = 7.275e-05, а значення |x[i+1]-x[i]| = 0.0010470586152822037, \\
            наближене значення кореня = -0.93826086 \\ } \par
Ітерація 5: \parbox[t]{12cm}{ відрізок [-0.93825827,-0.41], \\
            значення критерія |f(x)| = 0.0, а значення \\ |x[i+1]-x[i]| = 2.5935824589096157e-06, \\
            наближене значення кореня = -0.93825827 \\ } \par

Кількість ітерацій = 6, епсилон = 0.001, корінь = -0.93825827

\section{Висновки}

На кінець передпрограмного етапу було отримано один проміжок
$x \in $[-1.87,-0.41], на якому має бути один дійсний корінь 
початкового рівняння \[ P(x)=6x^5-3x^4+x^3+2x^2-4x+2=0.\]

Найшвидшим методом уточнення коренів на отриманому відрізку 
виявився метод Ньютона (лише за 6 ітерацій), а найповільнішим -- 
метод хорд (аж 63 ітерації).

\end{document}